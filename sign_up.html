<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <!----- Bootstrap cdn ----->

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

    <!----- CSS Stylesheet ----->

    <link rel="stylesheet" href="./css/auth.css">
</head>

<body>

    <!----- Signup card ----->

    <div class="container d-flex justify-content-center align-items-center">
        <div class="auth-card">
            <!-- <img src="https://cdn-icons-png.flaticon.com/512/1020/1020615.png" alt="ticket" class="ticket" /> -->
            <h3>Sign Up</h3>

            <form id="signUpForm" action="#">
                <div class="mb-3">
                    <input id="name" type="text" class="form-control" placeholder="Your Name" />
                    <span id="nameerr" class="error-text ps-1"></span>
                </div>
                <div class="mb-3">
                    <input id="email" type="email" class="form-control" placeholder="Email" />
                    <span id="emailerr" class="error-text ps-1"></span>
                </div>
                <div class="mb-3 position-relative">
                    <input type="password" id="password" class="form-control" placeholder="Password" />
                    <span id="passworderr" class="text-danger error-text ps-1" style="font-size: 14px;"></span>
                    <span id="togglePassword" class="position-absolute top-50 end-0 translate-middle-y pe-3"
                        style="color: gray; cursor: pointer;">
                        <i class="bi bi-eye-slash"></i>
                    </span>
                </div>
                <div class="mb-3">
                    <input id="date" type="date" class="form-control" placeholder="Date of Birth" />
                    <span id="dateerr" class="text-danger error-text ps-1" style="font-size: 14px;"></span>
                </div>
                <button type="button" class="btn btn-auth mt-2" onclick="validation()">Register</button>
            </form>

            <div class="auth-text">
                Already have an account? <a href="./login.html">Login</a>
            </div>
        </div>
    </div>

    <!----- Bootstrap Icons ----->

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" />

    <script>
        const passwordInput = document.getElementById("password");
        const togglePassword = document.getElementById("togglePassword");
        const icon = togglePassword.querySelector("i");

        togglePassword.addEventListener("click", () => {
            const isPassword = passwordInput.type === "password";

            // Toggle input type
            passwordInput.type = isPassword ? "text" : "password";

            // Toggle icon (Bootstrap Icons)
            icon.classList.toggle("bi-eye-slash");
            icon.classList.toggle("bi-eye");

            // Toggle text-muted color
            togglePassword.classList.toggle("text-muted");
            togglePassword.classList.toggle("text-dark");
        });

        let isValid = true;

        function validation() {
            let name = document.getElementById("name").value;

            if (name === "") {
                let nameerr = document.getElementById("nameerr");
                nameerr.innerHTML = "Name is required";
                nameerr.style.color = "red";
                isValid = false;
            }

            let email = document.getElementById("email").value;

            if (email === "") {
                let emailerr = document.getElementById("emailerr");
                emailerr.innerHTML = "Email is required";
                emailerr.style.color = "red";
                isValid = false;
            }
            else {
                let regex = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;
                if (!regex.test(email)) {
                    let emailerr = document.getElementById("emailerr");
                    emailerr.innerHTML = "Email is not valid";
                    emailerr.style.color = "red";
                    isValid = false;
                }
            }

            let password = document.getElementById("password").value;
            if (password === "") {
                let passworderr = document.getElementById("passworderr");
                passworderr.innerHTML = "Password is required";
                passworderr.style.color = "red";
                isValid = false;
            }
            else {

                if (password.length < 6) {
                    passworderr.innerHTML = "Minimun char is 6";
                    passworderr.style.color = "red";
                    isValid = false;
                }
                else if (password.length > 10) {
                    passworderr.innerHTML = "Maximun char is 10";
                    passworderr.style.color = "red";
                    isValid = false;
                }
                else if (!/(?=.*[A-Z])/.test(password)) {
                    passworderr.innerHTML = "Ateast one uppercase letter";
                    passworderr.style.color = "red";
                    isValid = false;
                }
                else if (!/(?=.*[a-z])/.test(password)) {
                    passworderr.innerHTML = "Ateast one lowercase letter";
                    passworderr.style.color = "red";
                    isValid = false;
                }
                else if (!/(?=.*[@$!%*?&])/.test(password)) {
                    passworderr.innerHTML = "Ateast one special";
                    passworderr.style.color = "red";
                    isValid = false;
                }
                else if (!/(?=.*[@$!%*?&])/.test(password)) {
                    passworderr.innerHTML = "Ateast one special";
                    passworderr.style.color = "red";
                    isValid = false;
                }
            }

            let date = document.getElementById("date").value;

            if (date === "") {
                let dateerr = document.getElementById("dateerr");
                dateerr.innerHTML = "Date is required";
                dateerr.style.color = "red";
                isValid = false;
            }

            if (isValid) {
                let name = document.getElementById("name").value;
                let email = document.getElementById("email").value;
                let password = document.getElementById("password").value;
                let date = document.getElementById("date").value;

                let user = {
                    name: name,
                    email: email,
                    password: password
                };

                // Save to localStorage
                localStorage.setItem("user", JSON.stringify(user));  //store details
                localStorage.setItem("loggedInUser", name);  //store name for navbar

                alert("Signup successful!");
                window.location.href = "../user/user_home.html";
            }

        }
    </script>
</body>

</html>